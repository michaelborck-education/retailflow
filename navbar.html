<!-- Navigation Bar Template -->
<header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark" data-bs-theme="dark">
        <div class="navbar-container container-fluid">
            <div class="navbar-brand-container mx-auto">
                <a href="/" class="navbar-brand" id="navbar-home-link">
                    <span class="navbar-title">RetailFlow Masterclass</span>
                </a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav navbar-nav-scroll me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/" id="nav-home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/consultant.html" id="nav-dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" id="nav-crisis">Crisis Scenarios</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/crisis/crisis-1-data-quality.html">Crisis 1: Data Quality</a></li>
                            <li><a class="dropdown-item" href="/crisis/crisis-2-staff-resistance.html">Crisis 2: Staff Resistance</a></li>
                            <li><a class="dropdown-item" href="/crisis/crisis-3-executive-pressure.html">Crisis 3: Executive Pressure</a></li>
                            <li><a class="dropdown-item" href="/crisis/crisis-4-ethical-dilemma.html">Crisis 4: Ethical Dilemma</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/decisions/scale-or-kill-cases.html" id="nav-decisions">Scale/Kill Decisions</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<script>
// Initialize navbar based on current page
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;
    const homeLink = document.getElementById('navbar-home-link');
    const homeNav = document.getElementById('nav-home');
    const dashboardNav = document.getElementById('nav-dashboard');
    const crisisNav = document.getElementById('nav-crisis');
    const decisionsNav = document.getElementById('nav-decisions');
    
    // Determine root path for relative links
    let rootPath = '/';
    if (currentPath.includes('/crisis/')) {
        rootPath = '../';
        homeLink.href = '../index.html';
        homeNav.href = '../index.html';
        dashboardNav.href = '../consultant.html';
        decisionsNav.href = '../decisions/scale-or-kill-cases.html';
        
        // Update crisis links to be relative
        document.querySelectorAll('.dropdown-menu .dropdown-item').forEach(link => {
            const href = link.getAttribute('href');
            link.href = href.replace('/crisis/', '');
        });
    } else if (currentPath.includes('/decisions/')) {
        rootPath = '../';
        homeLink.href = '../index.html';
        homeNav.href = '../index.html';
        dashboardNav.href = '../consultant.html';
        
        // Update crisis links to be relative
        document.querySelectorAll('.dropdown-menu .dropdown-item').forEach(link => {
            const href = link.getAttribute('href');
            link.href = href.replace('/crisis/', '../crisis/');
        });
    }
    
    // Mark current page as active
    if (currentPath === '/' || currentPath.endsWith('/index.html')) {
        homeNav.classList.add('active');
    } else if (currentPath.includes('consultant')) {
        dashboardNav.classList.add('active');
    } else if (currentPath.includes('/crisis/')) {
        crisisNav.classList.add('active');
        crisisNav.parentElement.classList.add('active');
        
        // Mark specific crisis as active
        document.querySelectorAll('.dropdown-menu .dropdown-item').forEach(link => {
            if (link.getAttribute('href').includes(currentPath.split('/').pop())) {
                link.classList.add('active');
            }
        });
    } else if (currentPath.includes('scale-or-kill')) {
        decisionsNav.classList.add('active');
    }
});
</script>
